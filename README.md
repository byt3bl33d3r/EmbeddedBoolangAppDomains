# EmbeddedBoolang


## The Good

It works perfectly if you compile and just run the resulting binary:

<img width="617" alt="image" src="https://user-images.githubusercontent.com/5151193/56261014-aae4e800-6096-11e9-8585-11d93436592b.png">


## The Bad 

Embedding the resulting Assembly in anything (MSBuild, PowerShell etc..) results in an error:

<img width="1123" alt="image" src="https://user-images.githubusercontent.com/5151193/56261224-6f96e900-6097-11e9-9e26-eec504bf4321.png">

The above powershell script was generated by using Out-CompressedDLL from the Powersploit Repo with little modifications to invoke the `Main` function

It's included in this repo as `embedded_boo.ps1`

## The Ugly

This has been driving me crazy for a few months now, the same thing happens when trying to spin up IronPython Engines in diffrent appdomains as well, it's obviously something to do with the Object serialization between AppDomains i just don't know C# well enough to figure out the cause.

I'm almost 100% sure it's something really dumb